@model  ClassLibrary.Models.M_MOP_PLAN
<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.js"></script>


<script type="text/javascript">
    $(document).ready(function () {
        $("#btnSubmit").click(function (e) {
            e.preventDefault();
            if (validate()) {
                $.ajax({
                    type: "POST",
                    async: false,
                    url: "@Url.Action("EditPlan")",
                    dataType: 'json',
                    data: {
                        SiteId: $('#SiteId').val(),
                        MOP_No: $('#MOP_No').val(),
                        PMS_No: $('#PMS_No').val(),
                        ESWBS: $('#ESWBS').val(),
                        SelectedDate: $('#SelectedDate').val(),
                        Status: $('#Actions').val(),
                    },
                    cache: false,
                    success: function (data) {
                        if (data.type == "success")
                        {
                            $("#divMopPlanModal").modal('hide');
                            swal({ title: "Success", text: data.msg, type: "success", });
                        }
                        else if (data.type == "error" || data.type == "failure")
                        {

                            swal({ title: "Error", text: data.msg, type: "error", });
                        }
                    }
                });
            }
        });
    });

    function validate()
    {
        var isValid = true;
        var msg;
        if ($('#SelectedDate').val().length <= 0) {
            msg = "Please select date";
            isValid = false;
        }

        if (!isValid) {
            swal({ title: "Error", text: msg, type: "error", });
        }

        return isValid;
    }
</script>


<div class="modal-header">

    <h4 class="modal-title">Edit Mop Plan</h4>

    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
</div>


<div class="modal-body" id="modalbody">
    @using (Html.BeginForm("Edit", "Mop", FormMethod.Post, new { @id = "formMopPlan" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.SiteId)
 

        <div class="card card-primary">
            <br />
            <div class="card-body" id="InputFields">
                <div class="form-group row">

                    <div class="col-md-6">
                        <label class="col-md col-form-label">Site Id</label>
                        <div class="col-md-12">
                            @Html.EditorFor(model => model.SiteId, new { htmlAttributes = new { @class = "form-control", @id = "siteId", @disabled = true, @readonly = true } })
                        </div>
                    </div>

                    <div class="col-md-6">
                        <label class="col-md col-form-label">PMS No.</label>
                        <div class="col-md-12">
                            @Html.EditorFor(model => model.PMS_No, new { htmlAttributes = new { @class = "form-control", @disabled = true, @readonly = true } })
                        </div>

                    </div>
                </div>

                <div class="form-group row">

                    <div class="col-md-6">
                        <label class="col-md col-form-label">MOP No.</label>
                        <div class="col-md-12">
                            @Html.EditorFor(model => model.MOP_No, new { htmlAttributes = new { @class = "form-control", @disabled = true, @readonly = true } })
                        </div>
                    </div>

                    <div class="col-md-6">
                        <label class="col-md col-form-label">ESWBS</label>
                        <div class="col-md-12">
                            @Html.EditorFor(model => model.ESWBS, new { htmlAttributes = new { @class = "form-control", @disabled = true, @readonly = true } })
                        </div>
                    </div>

                </div>

                <div class="form-group row">

                    <div class="col-md-6">
                        <label class="col-md-2 col-form-label">Date</label>
                        <div class="col-md-12">
                            @(Html.DevExtreme().DateBoxFor(model => model.SelectedDate).Type(DateBoxType.Date).Value(DateTime.Now))
                        </div>
                    </div>

                    @if (Model.NextDueDate == null && Model.DoneDate == null)
                    {

                    }
                    else
                    {
                        <div class="col-md-6">
                            <label class="col-md-2 col-form-label">Status</label>
                            <div class="col-md-12">
                                @Html.DropDownListFor(model => model.Actions, new SelectList(Model.Actions, "Key", "Value"), "Select", new { @class = "form-control", @required = "true" })
                                @Html.ValidationMessageFor(model => model.Actions, "", new { @class = "text-danger" })
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>

        <div class="card-footer" id="footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" id="btnSubmit" class="btn btn-primary float-right">Save Changes</button>
        </div>
    }

</div>
